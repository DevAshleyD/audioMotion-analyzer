!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var i,o,a,r,d,l,c,h,s,u,f,g,m,p,w,v,M,x,b,y,S,E,k,L,I,q,R,B,H,C,F,A,P;n.r(t);var T={classic:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )",{pos:.6,color:"hsl( 60, 100%, 50% )"},"hsl( 120, 100%, 50% )"]},prism:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"]},rainbow:{bgColor:"#111",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"]}},V={mode:0,fftSize:8192,freqMin:20,freqMax:22e3,smoothing:.5,gradient:"classic",showBgColor:!0,showLeds:!1,showScale:!0,highSens:!1,showPeaks:!0,showFPS:!1,loRes:!1,width:640,height:270};function _(){return document.fullscreenElement===y}function z(){return void 0!==B}function O(e=-85,t=-25){!0===e?(x.minDecibels=-100,x.maxDecibels=-30):!1===e?(x.minDecibels=-85,x.maxDecibels=-25):(x.minDecibels=Math.min(e,t),x.maxDecibels=Math.max(e,t))}function j(){var e,t;if(m=Math.log10(f),p=y.width/(Math.log10(g)-m),u=[],0==i){var n,o=-1,a=Math.floor(f*x.fftSize/M.sampleRate),r=Math.round(g*x.fftSize/M.sampleRate);for(w=1,e=a;e<=r;e++)t=e*M.sampleRate/x.fftSize,(n=Math.round(p*(Math.log10(t)-m)))>o?(u.push({posX:n,dataIdx:e,endIdx:0,average:!1,peak:0,hold:0,accel:0}),o=n):u.length&&(u[u.length-1].endIdx=e)}else{var d;switch(i){case 24:d=Math.min(16,y.height/(33*E)|0),v={nLeds:Math.min(24,y.height/(2*d*E)|0),spaceV:d,spaceH:Math.min(24,y.width/(40*E)|0)};break;case 12:d=Math.min(8,y.height/(67*E)|0),v={nLeds:Math.min(48,y.height/(2*d*E)|0),spaceV:d,spaceH:Math.min(16,y.width/(60*E)|0)};break;case 8:d=Math.min(6,y.height/(90*E)|0),v={nLeds:Math.min(64,y.height/(2*d*E)|0),spaceV:d,spaceH:Math.min(10,y.width/(96*E)|0)};break;case 4:d=Math.min(6,y.height/(90*E)|0),v={nLeds:Math.min(80,y.height/(2*d*E)|0),spaceV:d,spaceH:Math.min(8,y.width/(120*E)|0)};break;case 2:d=Math.min(4,y.height/(135*E)|0),v={nLeds:Math.min(128,y.height/(2*d*E)|0),spaceV:d,spaceH:Math.min(4,y.width/(240*E)|0)};break;default:d=Math.min(3,Math.max(2,y.height/(180*E)|0)),v={nLeds:Math.min(128,y.height/(2*d*E)|0),spaceV:d,spaceH:Math.min(4,y.width/(320*E)|0)}}v.spaceH*=E,v.spaceV*=E,v.ledHeight=y.height/v.nLeds-v.spaceV;var l=[],c=0;for(e=0;(t=16.351597831287403*(2**(1/24))**e)<=g;)t>=f&&e%i==0&&l.push(t),e++;w=Math.floor(y.width/l.length)-1;var h=Math.round(y.width-w*l.length)/(l.length-1);C.width|=0,l.forEach(function(e,t){var n,i,o=Math.round(e*x.fftSize/M.sampleRate),a=!1;n=c>0&&c+1<=o?c+1:o,c=i=o,void 0!==l[t+1]&&((i=Math.round(l[t+1]*x.fftSize/M.sampleRate))-o>1?c+=Math.round((i-o)/2):i-o==1&&u.length>0&&n==u[u.length-1].dataIdx&&(a=!0,c+=Math.round((i-o)/2))),u.push({posX:t*(w+h),dataIdx:n,endIdx:c-n>0?c:0,average:a,peak:0,hold:0,accel:0}),F.fillRect(u[u.length-1].posX-v.spaceH/2,0,v.spaceH,y.height)})}if(i>0)for(F.fillRect(u[u.length-1].posX+w-v.spaceH/2+(i<8?2:1),0,v.spaceH,y.height),e=v.ledHeight;e<y.height;e+=v.ledHeight+v.spaceV)F.fillRect(0,e,y.width,v.spaceV);D()}function D(){var e=5*E;_()&&(e*=2),S.fillStyle="#000c",S.fillRect(0,y.height-4*e,y.width,4*e),d&&(S.fillStyle="#fff",S.font=2*e+"px sans-serif",S.textAlign="center",[16,31,63,125,250,500,1e3,2e3,4e3,8e3,16e3].forEach(function(t){var n=p*(Math.log10(t)-m);S.fillText(t>=1e3?t/1e3+"k":t,n,y.height-e)}))}function X(){var e,t,n,c=r&&i>0;S.fillStyle=a?c?"#111":T[o].bgColor:"#000",S.fillRect(0,0,y.width,y.height),x.getByteFrequencyData(b),e=u.length;for(let i=0;i<e;i++){if(0==(t=u[i]).endIdx)n=b[t.dataIdx];else if(n=0,t.average){for(let e=t.dataIdx;e<=t.endIdx;e++)n+=b[e];n/=t.endIdx-t.dataIdx+1}else for(let e=t.dataIdx;e<=t.endIdx;e++)n=Math.max(n,b[e]);(n=c?(n/255*v.nLeds|0)*(v.ledHeight+v.spaceV):n/255*y.height|0)>=t.peak&&(t.peak=n,t.hold=30,t.accel=0),S.fillStyle=T[o].gradient,c?S.fillRect(t.posX+v.spaceH/2,y.height,w,-n):S.fillRect(t.posX,y.height,w,-n),t.peak>0&&(l&&(c?S.fillRect(t.posX+v.spaceH/2,(v.nLeds-(t.peak/y.height*v.nLeds|0))*(v.ledHeight+v.spaceV),w,v.ledHeight):S.fillRect(t.posX,y.height-t.peak,w,2)),t.hold?t.hold--:(t.accel++,t.peak-=t.accel))}c&&S.drawImage(C,0,0),d&&D(),P++;let h=performance.now(),f=h-A;if(f>=1e3&&(R=P/(f/1e3),P=0,A=h),s){let e=20*E;S.font=`bold ${e}px sans-serif`,S.fillStyle="#0f0",S.textAlign="right",S.fillText(R.toFixed(),y.width-e,2*e)}H&&H(y,S,E),B=requestAnimationFrame(X)}function $(){var e;Object.keys(T).forEach(function(t){e=T[t].dir&&"h"==T[t].dir?S.createLinearGradient(0,0,y.width,0):S.createLinearGradient(0,0,0,y.height),T[t].colorStops&&T[t].colorStops.forEach((n,i)=>{"object"==typeof n?e.addColorStop(n.pos,n.color):e.addColorStop(i/(T[t].colorStops.length-1),n)}),T[t].gradient=e})}function G(){E=window.devicePixelRatio,h&&(E/=2),I=Math.max(window.screen.width,window.screen.height)*E,q=Math.min(window.screen.height,window.screen.width)*E,_()?(y.width=I,y.height=q):(y.width=k*E,y.height=L*E),2==E&&window.screen.height<=540&&(E=1),S.fillStyle="#000",S.fillRect(0,0,y.width,y.height),$(),C=y.cloneNode(),(F=C.getContext("2d")).fillStyle="#000",j()}function N(e){var t=z();return void 0===e&&(e=!t),t&&!e?(cancelAnimationFrame(B),B=void 0):!t&&e&&(P=R=0,A=performance.now(),B=requestAnimationFrame(X)),z()}var W=document.getElementById("audio");try{!function(e,t={}){e||(e=document.body);var n,u=window.AudioContext||window.webkitAudioContext;try{M=new u}catch(e){throw"Could not create audio context. Web Audio API not supported?"}x=M.createAnalyser(),t.source&&(n=function(e){var t=M.createMediaElementSource(e);return t.connect(x),t}(t.source)),x.connect(M.destination),V.width=e.clientWidth||V.width,V.height=e.clientHeight||V.height,i=void 0===t.mode?V.mode:Number(t.mode),f=void 0===t.freqMin?V.freqMin:t.freqMin,g=void 0===t.freqMax?V.freqMax:t.freqMax,o=void 0===t.gradient?V.gradient:t.gradient,a=void 0===t.showBgColor?V.showBgColor:t.showBgColor,r=void 0===t.showLeds?V.showLeds:t.showLeds,d=void 0===t.showScale?V.showScale:t.showScale,c=void 0===t.highSens?V.highSens:t.highSens,l=void 0===t.showPeaks?V.showPeaks:t.showPeaks,s=void 0===t.showFPS?V.showFPS:t.showFPS,h=void 0===t.loRes?V.loRes:t.loRes,k=void 0===t.width?V.width:t.width,L=void 0===t.height?V.height:t.height,x.fftSize=void 0===t.fftSize?V.fftSize:t.fftSize,x.smoothingTimeConstant=void 0===t.smoothing?V.smoothing:t.smoothing,b=new Uint8Array(x.frequencyBinCount),"function"==typeof t.drawCallback&&(H=t.drawCallback),O(c),(y=document.createElement("canvas")).style="max-width: 100%;",e.appendChild(y),S=y.getContext("2d",{alpha:!1}),G(),y.addEventListener("fullscreenchange",G),window.addEventListener("resize",()=>{k=t.width||e.clientWidth||V.width,L=t.height||e.clientHeight||V.height,G()}),void 0!==t.start&&!1===t.start||N(!0)}(document.getElementById("container"),{mode:4,source:W,freqMin:30,freqMax:16e3,showFPS:!0,drawCallback:function(e,t,n){var i=20*n;_()&&(i*=2);t.font=`${i}px Orbitron,sans-serif`;var o=t.measureText("audioMotion").width/2;t.font=`${i+b[1]/16*n}px Orbitron,sans-serif`,t.fillStyle="#fff8",t.textAlign="center",t.fillText("audioMotion",i+o,2*i)}})}catch(e){document.getElementById("container").innerHTML=`<p>audioMotion failed with error: <em>${e}</em></p>`}var U=M,J=U.createOscillator(),K=U.createGain();J.frequency.setValueAtTime(0,U.currentTime),J.connect(K),J.start(),K.connect(x),document.getElementById("btn_fullscr").addEventListener("click",()=>void(_()?document.exitFullscreen():y.requestFullscreen?y.requestFullscreen():y.webkitRequestFullscreen?y.webkitRequestFullscreen():y.mozRequestFullScreen?y.mozRequestFullScreen():y.msRequestFullscreen&&y.msRequestFullscreen())),document.getElementById("btn_bgcolor").addEventListener("click",()=>(function(e){return a=void 0===e?!a:e})()),document.getElementById("btn_peaks").addEventListener("click",()=>(function(e){return l=void 0===e?!l:e})()),document.getElementById("btn_leds").addEventListener("click",()=>(function(e){return r=void 0===e?!r:e})()),document.getElementById("btn_scale").addEventListener("click",()=>(function(e){return d=void 0===e?!d:e})()),document.getElementById("btn_lores").addEventListener("click",()=>(function(e){return h=void 0===e?!h:e,G(),h})()),document.getElementById("btn_fps").addEventListener("click",()=>(function(e){return s=void 0===e?!s:e})()),document.getElementById("btn_freeze").addEventListener("click",()=>N()),document.getElementById("mode").addEventListener("change",e=>(function(e=V.mode){i=Number(e),j()})(e.target.value)),document.getElementById("gradient").addEventListener("change",e=>(function(e=V.gradient){o=e})(e.target.value)),document.getElementById("range").addEventListener("change",e=>{let t=e.target[e.target.selectedIndex];!function(e=V.freqMin,t=V.freqMax){f=Math.min(e,t),g=Math.max(e,t),j()}(t.dataset.min,t.dataset.max)}),document.querySelectorAll(".tones").forEach(e=>e.addEventListener("click",e=>{J.type=e.target.dataset.wave,J.frequency.setValueAtTime(e.target.dataset.freq,U.currentTime),K.gain.setValueAtTime(.2,U.currentTime)})),document.getElementById("btn_soundoff").addEventListener("click",()=>K.gain.setValueAtTime(0,U.currentTime)),document.getElementById("uploadFile").addEventListener("change",e=>(function(e){var t=new FileReader;t.readAsDataURL(e.files[0]),t.onload=()=>{W.src=t.result,W.play()}})(e.target))}]);