!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AudioMotionAnalyzer=e():t.AudioMotionAnalyzer=e()}(self,(function(){return(()=>{"use strict";var t={954:(t,e,i)=>{i.d(e,{default:()=>s});class s{constructor(t,e={}){this._initDone=!1,this._gradients={classic:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )",{pos:.6,color:"hsl( 60, 100%, 50% )"},"hsl( 120, 100%, 50% )"]},prism:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"]},rainbow:{bgColor:"#111",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"]}},this._container=t||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270;const i=window.AudioContext||window.webkitAudioContext;if(e.hasOwnProperty("audioCtx")){if(!(e.audioCtx instanceof i))throw new a("ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid");this._audioCtx=e.audioCtx}else try{this._audioCtx=new i}catch(t){throw new a("ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?")}this._analyzer=[this._audioCtx.createAnalyser(),this._audioCtx.createAnalyser()],this._splitter=this._audioCtx.createChannelSplitter(2),this._merger=this._audioCtx.createChannelMerger(2),this._input=this._audioCtx.createGain(),this._output=this._audioCtx.createGain(),this._sources=[],e.source&&this.connectInput(e.source);for(let t=0;t<2;t++)this._splitter.connect(this._analyzer[t],t).connect(this._merger,0,t);this._merger.connect(this._output),this.connectOutput(),this._energy={instant:0,peak:0,hold:0},this._canvas=document.createElement("canvas"),this._canvas.style="max-width: 100%;",this._container.appendChild(this._canvas),this._canvasCtx=this._canvas.getContext("2d"),this._labels=document.createElement("canvas"),this._circScale=document.createElement("canvas");const s=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout((()=>{this._fsChanging||(this._setCanvas("resize"),this._fsTimeout=0)}),60))};window.ResizeObserver&&new ResizeObserver(s).observe(this._container),window.addEventListener("resize",s),this._canvas.addEventListener("fullscreenchange",(()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas("fschange"),this._fsTimeout=window.setTimeout((()=>{this._fsChanging=!1,this._fsTimeout=0}),60)})),this._calculateInternals(),this._setProperties(e,!0),this._initDone=!0,this._setCanvas("create")}get barSpace(){return this._barSpace}set barSpace(t){this._barSpace=Number(t)||0,this._calculateInternals()}get fftSize(){return this._analyzer[0].fftSize}set fftSize(t){for(let e=0;e<2;e++)this._analyzer[e].fftSize=t;this._dataArray=new Uint8Array(this._analyzer[0].frequencyBinCount),this._precalculateBarPositions()}get gradient(){return this._gradient}set gradient(t){if(!this._gradients.hasOwnProperty(t))throw new a("ERR_UNKNOWN_GRADIENT",`Unknown gradient: '${t}'`);this._gradient=t}get height(){return this._height}set height(t){this._height=t,this._setCanvas("user")}get width(){return this._width}set width(t){this._width=t,this._setCanvas("user")}get mode(){return this._mode}set mode(t){const e=0|t;if(!(e>=0&&e<=10&&9!=e))throw new a("ERR_INVALID_MODE",`Invalid mode: ${t}`);this._mode=e,this._calculateInternals(),this._precalculateBarPositions(),this._generateGradients()}get loRes(){return this._loRes}set loRes(t){this._loRes=!!t,this._setCanvas("lores")}get lumiBars(){return this._lumiBars}set lumiBars(t){this._lumiBars=!!t,this._calculateInternals(),this._calculateLedProperties(),this._generateGradients()}get radial(){return this._radial}set radial(t){this._radial=!!t,this._calculateInternals(),this._calculateLedProperties(),this._generateGradients()}get spinSpeed(){return this._spinSpeed}set spinSpeed(t){t=Number(t)||0,void 0!==this._spinSpeed&&0!=t||(this._spinAngle=-Math.PI/2),this._spinSpeed=t}get reflexRatio(){return this._reflexRatio}set reflexRatio(t){if((t=Number(t)||0)<0||t>=1)throw new a("ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1");this._reflexRatio=t,this._calculateInternals(),this._generateGradients(),this._calculateLedProperties()}get minFreq(){return this._minFreq}set minFreq(t){if(t<1)throw new a("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=t,this._precalculateBarPositions()}get maxFreq(){return this._maxFreq}set maxFreq(t){if(t<1)throw new a("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._maxFreq=t,this._precalculateBarPositions()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(t){for(let e=0;e<2;e++)this._analyzer[e].minDecibels=t}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(t){for(let e=0;e<2;e++)this._analyzer[e].maxDecibels=t}get showLeds(){return this._showLeds}set showLeds(t){this._showLeds=!!t,this._calculateInternals()}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(t){for(let e=0;e<2;e++)this._analyzer[e].smoothingTimeConstant=t}get splitGradient(){return this._splitGradient}set splitGradient(t){this._splitGradient=!!t,this._generateGradients()}get stereo(){return this._stereo}set stereo(t){this._stereo=!!t,this._input.disconnect(),this._analyzer[0].disconnect(),this._input.connect(this._stereo?this._splitter:this._analyzer[0]),this._analyzer[0].connect(this._stereo?this._merger:this._output),this._calculateInternals(),this._generateScaleX(),this._calculateLedProperties(),this._generateGradients()}get volume(){return this._output.gain.value}set volume(t){this._output.gain.value=t}get audioCtx(){return this._audioCtx}get canvas(){return this._canvas}get canvasCtx(){return this._canvasCtx}get connectedSources(){return this._sources}get energy(){return this._energy.instant}get fsWidth(){return this._fsWidth}get fsHeight(){return this._fsHeight}get fps(){return this._fps}get isFullscreen(){return(document.fullscreenElement||document.webkitFullscreenElement)===this._canvas}get isOctaveBands(){return this._isOctaveBands}get isLedDisplay(){return this._isLedDisplay}get isLumiBars(){return this._isLumiBars}get isOn(){return void 0!==this._animationReq}get peakEnergy(){return this._energy.peak}get pixelRatio(){return this._pixelRatio}static get version(){return"3.0.0-beta.1"}connectInput(t){const e=t instanceof HTMLMediaElement;if(!(e||t instanceof AudioNode))throw new a("ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode");const i=e?this._audioCtx.createMediaElementSource(t):t;return this._sources.includes(i)||(i.connect(this._input),this._sources.push(i)),i}disconnectInput(t){t?Array.isArray(t)||(t=[t]):t=Array.from(this._sources);for(const e of t){const t=this._sources.indexOf(e);t>=0&&(e.disconnect(this._input),this._sources.splice(t,1))}}connectOutput(t=this._audioCtx.destination){this._output.connect(t)}disconnectOutput(t){this._output.disconnect(t)}registerGradient(t,e){if("string"!=typeof t||0==t.trim().length)throw new a("ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string");if("object"!=typeof e)throw new a("ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object");if(void 0===e.colorStops||e.colorStops.length<2)throw new a("ERR_GRADIENT_MISSING_COLOR","Gradient must define at least two colors");this._gradients[t]={},void 0!==e.bgColor?this._gradients[t].bgColor=e.bgColor:this._gradients[t].bgColor="#111",void 0!==e.dir&&(this._gradients[t].dir=e.dir),this._gradients[t].colorStops=e.colorStops,this._generateGradients()}setCanvasSize(t,e){this._width=t,this._height=e,this._setCanvas("user")}setFreqRange(t,e){if(t<1||e<1)throw new a("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=Math.min(t,e),this._maxFreq=Math.max(t,e),this._precalculateBarPositions()}setOptions(t){this._setProperties(t)}setSensitivity(t,e){for(let i=0;i<2;i++)this._analyzer[i].minDecibels=Math.min(t,e),this._analyzer[i].maxDecibels=Math.max(t,e)}toggleAnalyzer(t){const e=this.isOn;return void 0===t&&(t=!e),e&&!t?(cancelAnimationFrame(this._animationReq),this._animationReq=void 0):!e&&t&&(this._frame=this._fps=0,this._time=performance.now(),this._animationReq=requestAnimationFrame((t=>this._draw(t)))),this.isOn}toggleFullscreen(){this.isFullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():this._canvas.requestFullscreen?this._canvas.requestFullscreen():this._canvas.webkitRequestFullscreen&&this._canvas.webkitRequestFullscreen()}_calculateInternals(){this._analyzerRadius=this._canvas.height*(this._stereo?.375:.125)|0,this._barSpacePx=Math.min(this._barWidth-1,this._barSpace>0&&this._barSpace<1?this._barWidth*this._barSpace:this._barSpace),this._isOctaveBands=this._mode%10!=0,this._isLedDisplay=this._showLeds&&this._isOctaveBands&&!this._radial,this._isLumiBars=this._lumiBars&&this._isOctaveBands&&!this._radial,this._maximizeLeds=!this._stereo||this._reflexRatio>0&&!this._isLumiBars;const t=this._stereo&&!this._radial;this._channelHeight=this._canvas.height-(t&&!this._isLedDisplay?.5:0)>>t,this._channelGap=t?this._canvas.height-2*this._channelHeight:0}_calculateLedProperties(){if(!this._isOctaveBands||!this._initDone)return;let t,e=this._channelHeight*(this._lumiBars?1:1-this._reflexRatio)|0,i=Math.min(6,e/(90*this._pixelRatio)|0);switch(this._mode){case 8:i=Math.min(16,e/(33*this._pixelRatio)|0),t=24;break;case 7:i=Math.min(8,e/(67*this._pixelRatio)|0),t=48;break;case 6:t=64;break;case 5:case 4:t=80;break;case 3:t=96;break;case 2:i=Math.min(4,e/(135*this._pixelRatio)|0),t=128;break;case 1:i=Math.min(3,Math.max(2,e/(180*this._pixelRatio)|0)),t=128}i=Math.max(i,1)*this._pixelRatio,this._maximizeLeds&&(e+=i),t=Math.min(t,e/(2*i)|0),this._ledOptions={nLeds:t,spaceH:this._barWidth*(1==this._mode?.45:this._mode<5?.225:.125),spaceV:i,ledHeight:e/t-i}}_draw(t){const e=this._canvas,i=this._canvasCtx,s=this._isOctaveBands,a=this._isLedDisplay,h=this._isLumiBars,n=this._channelHeight,r=this._channelGap,o=n*(h||this._radial?1:1-this._reflexRatio)|0,l=e.width>>1,_=e.height>>1,c=this._analyzerRadius,d=2*Math.PI;this._energy.instant>0&&(this._spinAngle+=this._spinSpeed*d/3600);const u=(t,i)=>{const s=c+i,a=d*(t/e.width)+this._spinAngle;return[l+s*Math.cos(a),_+s*Math.sin(a)]},g=(t,e,s,a)=>{i.moveTo(...u(t,e)),i.lineTo(...u(t,e+a)),i.lineTo(...u(t+s,e+a)),i.lineTo(...u(t+s,e))},p=!this.showBgColor||a&&!this.overlay?"#000":this._gradients[this._gradient].bgColor;let f=this._barWidth-(s?Math.max(a?this._ledOptions.spaceH:0,this._barSpacePx):0);0!=this._barSpace||a||(f|=0);let m=0;const x=this._analyzerBars.length;for(let t=0;t<this._stereo+1;t++){const s=n*t+r*t,y=s+n,w=s+o-(a&&!this._maximizeLeds?this._ledOptions.spaceV:0);if(this.overlay&&i.clearRect(0,s-r,e.width,n+r),this.overlay&&!this.showBgColor||(this.overlay&&(i.globalAlpha=this.bgAlpha),i.fillStyle=p,this._radial&&0!=t||i.fillRect(0,s-r,e.width,(this.overlay&&1==this.reflexAlpha?o:n)+r),i.globalAlpha=1),this.showScaleY&&!h&&!this._radial){const t=this._labels.height,a=t>>1,h=o/(this._analyzer[0].maxDecibels-this._analyzer[0].minDecibels);i.fillStyle="#888",i.font=`${a}px sans-serif`,i.textAlign="right",i.lineWidth=1;for(let n=this._analyzer[0].maxDecibels;n>this._analyzer[0].minDecibels;n-=5){const r=s+(this._analyzer[0].maxDecibels-n)*h,o=n%2==0|0;if(o){const h=r+a*(r==s?.8:.35);i.fillText(n,.85*t,h),i.fillText(n,e.width-.1*t,h),i.strokeStyle="#888",i.setLineDash([2,4]),i.lineDashOffset=0}else i.strokeStyle="#555",i.setLineDash([2,8]),i.lineDashOffset=1;i.beginPath(),i.moveTo(t*o,.5+~~r),i.lineTo(e.width-t*o,.5+~~r),i.stroke()}i.setLineDash([]),i.lineDashOffset=0}a&&(i.setLineDash([this._ledOptions.ledHeight,this._ledOptions.spaceV]),i.lineWidth=f),i.fillStyle=i.strokeStyle=this._gradients[this._gradient].gradient,this._analyzer[t].getByteFrequencyData(this._dataArray),i.beginPath();for(let e=0;e<x;e++){let n=this._analyzerBars[e],r=0;if(0==n.endIdx){if(r=this._dataArray[n.dataIdx],n.factor){const t=n.dataIdx?this._dataArray[n.dataIdx-1]:r;r=t+(r-t)*n.factor}}else for(let t=n.dataIdx;t<=n.endIdx;t++)r=Math.max(r,this._dataArray[t]);r/=255,m+=r,h&&(i.globalAlpha=r),a?(r=(r*this._ledOptions.nLeds|0)*(this._ledOptions.ledHeight+this._ledOptions.spaceV)-this._ledOptions.spaceV,r<0&&(r=0)):r=r*(this._radial?_-c:o)|0,r>=n.peak[t]&&(n.peak[t]=r,n.hold[t]=30,n.accel[t]=0),this._radial&&1==t&&(r*=-1);let l=n.posX,d=f;if(10==this._mode)this._radial?(0==e&&n.dataIdx&&n.posX&&i.lineTo(...u(0,this._dataArray[n.dataIdx-1]/255*(_-c)*(1==t?-1:1))),n.posX>=0&&i.lineTo(...u(n.posX,r))):(0==e&&(i.moveTo(-this.lineWidth,w),n.dataIdx&&i.lineTo(-this.lineWidth,w-this._dataArray[n.dataIdx-1]/255*o)),i.lineTo(n.posX,w-r));else if(this._mode>0&&(a?l+=Math.max(this._ledOptions.spaceH/2,this._barSpacePx/2):0==this._barSpace?(l|=0,e>0&&l>this._analyzerBars[e-1].posX+f&&(l--,d++)):l+=this._barSpacePx/2),a){const t=l+f/2;if(this.showBgColor&&!this.overlay){const e=i.globalAlpha;i.beginPath(),i.moveTo(t,s),i.lineTo(t,w),i.strokeStyle="#7f7f7f22",i.globalAlpha=1,i.stroke(),i.strokeStyle=i.fillStyle,i.globalAlpha=e}i.beginPath(),i.moveTo(t,h?s:w),i.lineTo(t,h?y:w-r),i.stroke()}else this._radial?n.posX>=0&&g(l,0,d,r):i.fillRect(l,h?s:w,d,h?y:-r);if(n.peak[t]>1){if(this.showPeaks&&!h)if(a){const e=n.peak[t]/(o+this._ledOptions.spaceV)*this._ledOptions.nLeds|0,a=(this._ledOptions.nLeds-e-1)*(this._ledOptions.ledHeight+this._ledOptions.spaceV);i.fillRect(l,s+a,f,this._ledOptions.ledHeight)}else this._radial?10!=this.mode&&n.posX>=0&&g(l,n.peak[t]*(1==t?-1:1),d,-2):i.fillRect(l,w-n.peak[t],d,2);n.hold[t]?n.hold[t]--:(n.accel[t]++,n.peak[t]-=n.accel[t])}}if(i.globalAlpha=1,10==this._mode?(this._radial?i.closePath():i.lineTo(e.width+this.lineWidth,w),this.lineWidth>0&&(i.lineWidth=this.lineWidth,i.stroke()),this.fillAlpha>0&&(this._radial&&(i.moveTo(l+c,_),i.arc(l,_,c,0,d,!0)),i.globalAlpha=this.fillAlpha,i.fill(),i.globalAlpha=1)):this._radial&&i.fill(),this._reflexRatio>0&&!h){let a,h;this.reflexFit||this._stereo?(a=this._stereo&&0==t?n+r:0,h=n-o):(a=e.height-2*o,h=o),i.globalAlpha=this.reflexAlpha,1!=this.reflexBright&&(i.filter=`brightness(${this.reflexBright})`),i.setTransform(1,0,0,-1,0,e.height),i.drawImage(e,0,s,e.width,o,0,a,e.width,h),i.setTransform(1,0,0,1,0,0),i.filter="none",i.globalAlpha=1}}this._energy.instant=m/(x<<this._stereo),this._energy.instant>=this._energy.peak?(this._energy.peak=this._energy.instant,this._energy.hold=30):this._energy.hold>0?this._energy.hold--:this._energy.peak>0&&(this._energy.peak*=(30+this._energy.hold--)/30),i.setLineDash([]),this.showScaleX&&(this._radial?(i.save(),i.translate(l,_),0!=this._spinSpeed&&i.rotate(this._spinAngle+Math.PI/2),i.drawImage(this._circScale,-this._circScale.width>>1,-this._circScale.width>>1),i.restore()):i.drawImage(this._labels,0,e.height-this._labels.height)),this._frame++;const y=t-this._time;if(y>=1e3&&(this._fps=this._frame/(y/1e3),this._frame=0,this._time=t),this.showFPS){const t=20*this._pixelRatio;i.font=`bold ${t}px sans-serif`,i.fillStyle="#0f0",i.textAlign="right",i.fillText(Math.round(this._fps),e.width-t,2*t)}this.onCanvasDraw&&(i.save(),i.fillStyle=i.strokeStyle=this._gradients[this._gradient].gradient,this.onCanvasDraw(this),i.restore()),this._animationReq=requestAnimationFrame((t=>this._draw(t)))}_generateGradients(){this._isOctaveBands;const t=this._isLumiBars,e=t?this._canvas.height:this._canvas.height*(1-this._reflexRatio*!this._stereo)|0,i=1-this._reflexRatio,s=this._canvas.width>>1,a=this._canvas.height>>1,h=this._analyzerRadius;Object.keys(this._gradients).forEach((n=>{const r="h"==this._gradients[n].dir;let o;o=this._radial?this._canvasCtx.createRadialGradient(s,a,a,s,a,h-(a-h)*this._stereo):r?this._canvasCtx.createLinearGradient(0,0,this._canvas.width,0):this._canvasCtx.createLinearGradient(0,0,0,e);const l=this._gradients[n].colorStops;if(l){const e=this._stereo&&!this._splitGradient&&!r,s=(t,e)=>o.addColorStop(t,"object"==typeof e?e.color:e);for(let a=0;a<1+e;a++)l.forEach(((h,n)=>{const o=l.length-1;let _=void 0!==h.pos?h.pos:n/o;if(e&&(_/=2),!this._stereo||t||this._radial||r||(_*=i,!e&&_>.5*i&&(_+=.5*this._reflexRatio)),1==a)if(this._radial||t){const t=o-n;_=1-(void 0!==(h=l[t]).pos?h.pos:t/o)/2}else 0==n&&_>0&&s(.5,h),_+=.5;s(_,h),this._stereo&&n==o&&_<.5&&s(.5,h)}))}this._gradients[n].gradient=o}))}_generateScaleX(){const t=2*Math.PI,e=[16,31,63,125,250,500,1e3,2e3,4e3,8e3,16e3],i=this._labels.getContext("2d"),s=this._circScale.getContext("2d"),a=.03*this._canvas.height|0;this._circScale.width=this._circScale.height=(this._analyzerRadius<<1)+this._stereo*a;const h=this._circScale.width>>1,n=h-.7*a;this._labels.width|=0,i.fillStyle=s.strokeStyle="#000c",i.fillRect(0,0,this._labels.width,this._labels.height),s.arc(h,h,h-a/2,0,t),s.lineWidth=a,s.stroke(),i.fillStyle=s.fillStyle="#fff",i.font=(this._labels.height>>1)+"px sans-serif",s.font=(a>>1)+"px sans-serif",i.textAlign=s.textAlign="center";for(const a of e){const e=a>=1e3?a/1e3+"k":a,r=this._bandWidth*(Math.log10(a)-this._minLog);if(i.fillText(e,r,.75*this._labels.height),r>0&&r<this._canvas.width){const i=t*(r/this._canvas.width),a=i-Math.PI/2,o=n*Math.cos(a),l=n*Math.sin(a);s.save(),s.translate(h+o,h+l),s.rotate(i),s.fillText(e,0,0),s.restore()}}}_precalculateBarPositions(){if(!this._initDone)return;const t=t=>t*this._audioCtx.sampleRate/this._analyzer[0].fftSize,e=(t,e="round")=>{const i=Math[e](t*this._analyzer[0].fftSize/this._audioCtx.sampleRate);return i<this._analyzer[0].frequencyBinCount?i:this._analyzer[0].frequencyBinCount-1};let i,s;if(this._analyzerBars=[],this._isOctaveBands){let t;t=8==this._mode?24:7==this._mode?12:6==this._mode?8:5==this._mode?6:this._mode;const a=2**(1/24),h=440*a**-114;let n,r=[],o=0;for(;(n=h*a**o)<=this._maxFreq;)n>=this._minFreq&&o%t==0&&r.push(n),o++;i=Math.log10(r[0]),s=this._canvas.width/(Math.log10(r[r.length-1])-i),this._barWidth=this._canvas.width/r.length;let l=0,_=-1,c=0;r.forEach(((t,i)=>{const s=e(t);let a,h;if(a=l>0&&l+1<=s?l+1:s,a==_)c++;else{if(c>1)for(let t=0;t<c;t++)this._analyzerBars[this._analyzerBars.length-c+t].factor=(t+1)/c;_=a,c=1}l=h=s,void 0!==r[i+1]&&(h=e(r[i+1]),h-s>1&&(l+=Math.round((h-s)/2)));const n=l-a>0?l:0;this._analyzerBars.push({posX:i*this._barWidth,dataIdx:a,endIdx:n,factor:0,peak:[0,0],hold:[],accel:[]})}))}else{this._barWidth=1,i=Math.log10(this._minFreq),s=this._canvas.width/(Math.log10(this._maxFreq)-i);const a=e(this._minFreq,"floor"),h=e(this._maxFreq);let n=-999;for(let e=a;e<=h;e++){const a=t(e),h=Math.round(s*(Math.log10(a)-i));h>n?(this._analyzerBars.push({posX:h,dataIdx:e,endIdx:0,factor:0,peak:[0,0],hold:[],accel:[]}),n=h):this._analyzerBars.length&&(this._analyzerBars[this._analyzerBars.length-1].endIdx=e)}}this._minLog=i,this._bandWidth=s,this._calculateInternals(),this._generateScaleX(),this._calculateLedProperties()}_setCanvas(t){if(!this._initDone)return;this._pixelRatio=window.devicePixelRatio,this._loRes&&(this._pixelRatio/=2),this._fsWidth=Math.max(window.screen.width,window.screen.height)*this._pixelRatio,this._fsHeight=Math.min(window.screen.height,window.screen.width)*this._pixelRatio;const e=this.isFullscreen,i=e?this._fsWidth:(this._width||this._container.clientWidth||this._defaultWidth)*this._pixelRatio|0,s=e?this._fsHeight:(this._height||this._container.clientHeight||this._defaultHeight)*this._pixelRatio|0;2==this._pixelRatio&&window.screen.height<=540&&(this._pixelRatio=1),this._canvas.width==i&&this._canvas.height==s||(this._canvas.width=i,this._canvas.height=s,this._calculateInternals(),this.overlay||(this._canvasCtx.fillStyle="#000",this._canvasCtx.fillRect(0,0,this._canvas.width,this._canvas.height)),this._canvasCtx.lineJoin="bevel",this._labels.width=this._canvas.width,this._labels.height=Math.max(20*this._pixelRatio,this._canvas.height/27|0),this._generateGradients(),this._precalculateBarPositions(),void 0!==this._fsStatus&&this._fsStatus!==e&&(t="fschange"),this._fsStatus=e,this.onCanvasResize&&this.onCanvasResize(t,this))}_setProperties(t,e){const i=["onCanvasDraw","onCanvasResize"],s=["audioCtx","start"];(e||void 0===t)&&(t=Object.assign({mode:0,fftSize:8192,minFreq:20,maxFreq:22e3,smoothing:.5,gradient:"classic",minDecibels:-85,maxDecibels:-25,showBgColor:!0,showLeds:!1,showScaleX:!0,showScaleY:!1,showPeaks:!0,showFPS:!1,lumiBars:!1,loRes:!1,reflexRatio:0,reflexAlpha:.15,reflexBright:1,reflexFit:!0,lineWidth:0,fillAlpha:1,barSpace:.1,overlay:!1,bgAlpha:.7,radial:!1,spinSpeed:0,stereo:!1,splitGradient:!1,start:!0,volume:1},t));for(const e of Object.keys(t))-1!==i.indexOf(e)&&"function"!=typeof t[e]?this[e]=void 0:-1===s.indexOf(e)&&(this[e]=t[e]);void 0!==t.start&&this.toggleAnalyzer(t.start)}}class a extends Error{constructor(t,e){super(e),this.name="AudioMotionError",this.code=t}}}},e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={exports:{}};return t[s](a,a.exports,i),a.exports}return i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i(954)})().default}));